<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>4. Constructing a Cell · Nervos CKB</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Now that we have the tokens in the wallet that we created, we can now build additional functions to transfer tokens.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="4. Constructing a Cell · Nervos CKB"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.nervos.org/"/><meta property="og:description" content="&lt;p&gt;Now that we have the tokens in the wallet that we created, we can now build additional functions to transfer tokens.&lt;/p&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/nervos-logo.png" alt="Nervos CKB"/><h2 class="headerTitleWithLogo">Nervos CKB</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/introduction/welcome" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/tutorials/intro-tutorial" target="_self">Tutorial</a></li><li class=""><a href="https://github.com/nervosnetwork" target="_blank">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Tutorial</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tutorial<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/tutorials/intro-tutorial">Overview</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step1">1. Installing the Nervos CKB SDK</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step2">2. How to create a Wallet</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step3">3. Mining native tokens</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/tutorials/step4">4. Constructing a Cell</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step5">5. Constructing a Transaction</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step6">6. Transaction Signing</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step7">7. Scripts</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step8">8. Creating Lock Script</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step9">9. Sending a transaction</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step10">10. Retrieving Transaction Information</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step11">11. Receiving Native Tokens</a></li><li class="navListItem"><a class="navItem" href="/tutorials/step12">12. Finishing up</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/nervosnetwork/docs/edit/master/docs/tutorials/step4.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">4. Constructing a Cell</h1></header><article><div><span><p>Now that we have the tokens in the wallet that we created, we can now build additional functions to transfer tokens.</p>
<h2><a class="anchor" aria-hidden="true" id="recall"></a><a href="#recall" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Recall</h2>
<p>A cell is used to store binary data up to the cells capacity. A cell cannot be created if the capacity of the cells contents exceeds the allocated cells capacity as outlined in the capacity field
Occupied capacity &lt;= Cell Capacity
A cell contains the following fields: capacity, data, type script and lock script</p>
<h1><a class="anchor" aria-hidden="true" id="41-cell-creation"></a><a href="#41-cell-creation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.1 Cell Creation</h1>
<p>The cell to transfer tokens has no data in its data field, just capacity and the lock script that will be executed when unlocking the cell:</p>
<pre><code class="hljs"><span class="hljs-symbol">1 </span>  cell = {
<span class="hljs-symbol">2 </span>       capacity: <span class="hljs-number">500</span>,
<span class="hljs-symbol">3 </span>       <span class="hljs-keyword">data</span>: “”,
<span class="hljs-symbol">4 </span>       lock: wallet.lock,
<span class="hljs-symbol">5 </span>   }
</code></pre>
<ul>
<li><p><strong>Line 1</strong> - Defines the cell variable we will store the newly cell in</p></li>
<li><p><strong>Line 2</strong> - We have defined this cell to be created with 500 native tokens</p></li>
<li><p><strong>Lines 3</strong> - We leave the data field empty, because all we are concerned about is transferring native tokens, which do not require any data to be stored in this field.</p></li>
<li><p><strong>Lines 4</strong> - Specifies the lock script of who can unlock the cell and use it as a Cell Input in a subsequent transaction.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="calculating-cell-capacity"></a><a href="#calculating-cell-capacity" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Calculating Cell Capacity</h2>
<p>One cell can have a maximum capacity of 1000 Kb and a minimum capacity of Y such that 0 &lt; X &lt; 1000, where X is the capacity of a cell being created.</p>
<p>In this example, we will set capacity = 500</p>
<p>1 capacity = 500</p>
<h2><a class="anchor" aria-hidden="true" id="cell-capacities-as-change"></a><a href="#cell-capacities-as-change" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cell Capacities as Change</h2>
<p>There are instances where cells are created as change to send back to the original owner because input capacities are greater than output capacities</p>
<pre><code class="hljs"><span class="hljs-symbol">1 </span><span class="hljs-keyword">if</span> input_capacities &gt; capacity
<span class="hljs-symbol">2 </span>      outputs &lt;&lt; {
<span class="hljs-symbol">3 </span>         capacity: input_capacities - capacity,
<span class="hljs-symbol">4 </span>         <span class="hljs-keyword">data</span>: <span class="hljs-string">""</span>,
<span class="hljs-symbol">5 </span>         lock: lock
<span class="hljs-symbol">6 </span>       }
</code></pre>
<ul>
<li><p><strong>Line 1</strong> - Checks to see if the total input capacities in the transaction are greater than the outputs that are being sent</p></li>
<li><p><strong>Line 2</strong> - If true, we create a new cell to be placed as a Cell Output</p></li>
<li><p><strong>Lines 3</strong> - The capacity we send is the left over capacity not included in the outputs, so we can send it back to ourselves as change</p></li>
<li><p><strong>Lines 4</strong> - The data field is left blank as it is not required.</p></li>
<li><p><strong>Lines 5</strong> - We put the lock script of the owner of the wallet.</p></li>
</ul>
<p>Note: if we don’t construct a cell to send the left over capacity back to yourself, all left over capacity will be sent to the miner as a transaction fee!</p>
<h1><a class="anchor" aria-hidden="true" id="42-cell-data"></a><a href="#42-cell-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.2 Cell Data</h1>
<p>The data field of a cell contains binary data that you wish to store.  In this example, because we are transferring native tokens, we do not have to store any data. Further tutorials will demonstrate examples of storying different types of data in this field.</p>
<pre><code class="hljs"><span class="hljs-symbol">1 </span><span class="hljs-keyword">data</span> = “”
</code></pre>
<ul>
<li><strong>Line 1</strong> - Defines binary data that is included in this cell. For transferring native tokens, this can be left empty.</li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="43-cell-type-script"></a><a href="#43-cell-type-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.3 Cell Type Script</h1>
<p>Type Scripts  are <strong>optional</strong> scripts that are created to dictate how a cell can be used and spent. In this example, we will not create a type script because it is not required to send native tokens.</p>
<h1><a class="anchor" aria-hidden="true" id="44-cell-lock-script"></a><a href="#44-cell-lock-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.4 Cell Lock Script</h1>
<p>Lock Scripts are <strong>mandatory</strong>  scripts that are created to determine who can unlock a previous Transaction Output when included in a Transaction Input. In other words, a Lock Script is created at the time of the Cell being created, but it is executed and verified at the time the Cell is being spent(as part of a Cell Input in a Transaction Object)</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 5/13/2019</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/tutorials/step3"><span class="arrow-prev">← </span><span>3. Mining native tokens</span></a><a class="docs-next button" href="/tutorials/step5"><span>5. Constructing a Transaction</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#recall">Recall</a></li><li><a href="#calculating-cell-capacity">Calculating Cell Capacity</a></li><li><a href="#cell-capacities-as-change">Cell Capacities as Change</a></li></ul></nav></div></div></body></html>